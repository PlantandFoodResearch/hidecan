<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Creates a HIDECAN plot — create_hidecan_plot • hidecan</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a HIDECAN plot — create_hidecan_plot"><meta name="description" content="Creates a HIDECAN plot from a list of filtered GWAS or DE results
and/or candidate genes."><meta property="og:description" content="Creates a HIDECAN plot from a list of filtered GWAS or DE results
and/or candidate genes."><meta property="og:image" content="https://plantandfoodresearch.github.io/hidecan/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hidecan</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hidecan.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/hidecan-step-by-step.html">Step-by-step</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/gwaspoly_output.html">GWASpoly output</a></li>
    <li><a class="dropdown-item" href="../articles/web_only/shiny-app.html">Shiny app</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/PlantandFoodResearch/hidecan/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Creates a HIDECAN plot</h1>
      <small class="dont-index">Source: <a href="https://github.com/PlantandFoodResearch/hidecan/blob/main/R/create_hidecan_plot.R" class="external-link"><code>R/create_hidecan_plot.R</code></a></small>
      <div class="d-none name"><code>create_hidecan_plot.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates a HIDECAN plot from a list of filtered GWAS or DE results
and/or candidate genes.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">create_hidecan_plot</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  <span class="va">chrom_length</span>,</span>
<span>  colour_genes_by_score <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  remove_empty_chrom <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  chroms <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chrom_limits <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_rows <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_cols <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  legend_position <span class="op">=</span> <span class="st">"bottom"</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  label_size <span class="op">=</span> <span class="fl">3.5</span>,</span>
<span>  label_padding <span class="op">=</span> <span class="fl">0.15</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A list of <code>GWAS_data_thr</code>, <code>DE_data_thr</code> and/or <code>CAN_data_thr</code>
produced by the <code><a href="apply_threshold.html">apply_threshold</a>()</code> function. If named, the names
will be appended to the y-axis labels (use <code>' '</code> as empty name in the list).</p></dd>


<dt id="arg-chrom-length">chrom_length<a class="anchor" aria-label="anchor" href="#arg-chrom-length"></a></dt>
<dd><p>Tibble with columns <code>chromosome</code> and <code>length</code>, giving
for each chromosome its length in bp (see <code><a href="combine_chrom_length.html">combine_chrom_length</a>()</code>
function).</p></dd>


<dt id="arg-colour-genes-by-score">colour_genes_by_score<a class="anchor" aria-label="anchor" href="#arg-colour-genes-by-score"></a></dt>
<dd><p>Logical, whether to colour the genes by score
(<code>TRUE</code>) or by log2(fold-change) (<code>FALSE</code>). Default value is <code>TRUE</code>.</p></dd>


<dt id="arg-remove-empty-chrom">remove_empty_chrom<a class="anchor" aria-label="anchor" href="#arg-remove-empty-chrom"></a></dt>
<dd><p>Logical, should chromosomes with no significant
markers/genes nor candidate genes be removed from the plot? Default value
if <code>FALSE</code>.</p></dd>


<dt id="arg-chroms">chroms<a class="anchor" aria-label="anchor" href="#arg-chroms"></a></dt>
<dd><p>Character vector, name of chromosomes to include in the plot.
If <code>NULL</code> (default value), all chromosomes will be included.</p></dd>


<dt id="arg-chrom-limits">chrom_limits<a class="anchor" aria-label="anchor" href="#arg-chrom-limits"></a></dt>
<dd><p>Integer vector of length 2, or named list where the
elements are integer vectors of length 2. If vector, gives the lower and upper
limit of the chromosomes (in bp) to use in the plot. If a named list, names
should correspond to chromosome names. Gives for each chromosome the lower
and upper limits (in bp) to use in the plot. Doesn't have to be specified
for all chromosomes. Default value is <code>NULL</code>, i.e. no limits are applied
to the chromosomes (they will be plotted in their entirety).</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>Character, title of the plot. Default value is <code>NULL</code> (i.e.
no title will be added to the plot).</p></dd>


<dt id="arg-subtitle">subtitle<a class="anchor" aria-label="anchor" href="#arg-subtitle"></a></dt>
<dd><p>Character, subtitle of the plot. Default value is <code>NULL</code>
(i.e. no subtitle will be added to the plot).</p></dd>


<dt id="arg-n-rows">n_rows<a class="anchor" aria-label="anchor" href="#arg-n-rows"></a></dt>
<dd><p>Integer, number of rows of chromosomes to create in the plot.
Default value is <code>NULL</code>.</p></dd>


<dt id="arg-n-cols">n_cols<a class="anchor" aria-label="anchor" href="#arg-n-cols"></a></dt>
<dd><p>Integer, number of columns of chromosomes to create in the plot.
Default value is 2. Will be set to <code>NULL</code> if <code>n_rows</code> is not <code>NULL</code>.</p></dd>


<dt id="arg-legend-position">legend_position<a class="anchor" aria-label="anchor" href="#arg-legend-position"></a></dt>
<dd><p>Character, position of the legend in the plot. Can be
<code>bottom</code> (default value), <code>top</code>, <code>right</code>, <code>left</code> or <code>none</code>.</p></dd>


<dt id="arg-point-size">point_size<a class="anchor" aria-label="anchor" href="#arg-point-size"></a></dt>
<dd><p>Numeric, size of the points in the plot. Default value is 3.</p></dd>


<dt id="arg-label-size">label_size<a class="anchor" aria-label="anchor" href="#arg-label-size"></a></dt>
<dd><p>Numeric, size of the gene labels in the plot. Default value is
3.5 (for <code><a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a></code>).</p></dd>


<dt id="arg-label-padding">label_padding<a class="anchor" aria-label="anchor" href="#arg-label-padding"></a></dt>
<dd><p>Numeric, amount of padding around gene labels in the plot,
as unit or number. Default value is 0.15
(for <a href="https://ggrepel.slowkow.com/reference/geom_text_repel.html" class="external-link">geom_label_repel</a>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>ggplot</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_example_data.html">get_example_data</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"GWAS"</span> <span class="op">=</span> <span class="fu"><a href="GWAS_data.html">GWAS_data</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"GWAS"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="st">"DE"</span> <span class="op">=</span> <span class="fu"><a href="DE_data.html">DE_data</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"DE"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>          <span class="st">"CAN"</span> <span class="op">=</span> <span class="fu"><a href="CAN_data.html">CAN_data</a></span><span class="op">(</span><span class="va">x</span><span class="op">[[</span><span class="st">"CAN"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">chrom_length</span> <span class="op">&lt;-</span> <span class="fu"><a href="combine_chrom_length.html">combine_chrom_length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="apply_threshold.html">apply_threshold</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="st">"GWAS"</span><span class="op">]</span><span class="op">]</span>, score_thr <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="apply_threshold.html">apply_threshold</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="st">"DE"</span><span class="op">]</span><span class="op">]</span>, score_thr <span class="op">=</span> <span class="fl">1.3</span>, log2fc_thr <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="apply_threshold.html">apply_threshold</a></span><span class="op">(</span><span class="va">y</span><span class="op">[[</span><span class="st">"CAN"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">create_hidecan_plot</span><span class="op">(</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>                    <span class="va">chrom_length</span>,</span></span>
<span class="r-in"><span>                    label_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Colour genes according to their fold-change</span></span></span>
<span class="r-in"><span><span class="fu">create_hidecan_plot</span><span class="op">(</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>                    <span class="va">chrom_length</span>,</span></span>
<span class="r-in"><span>                    colour_genes_by_score <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                    label_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add names to the datasets</span></span></span>
<span class="r-in"><span><span class="fu">create_hidecan_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Genomics"</span>, <span class="st">"RNAseq"</span>, <span class="st">"My list"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    <span class="va">chrom_length</span>,</span></span>
<span class="r-in"><span>                    colour_genes_by_score <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                    label_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Add names to some of the datasets only (e.g. not for GWAS results)</span></span></span>
<span class="r-in"><span><span class="fu">create_hidecan_plot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="va">z</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">" "</span>, <span class="st">"RNAseq"</span>, <span class="st">"My list"</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                    <span class="va">chrom_length</span>,</span></span>
<span class="r-in"><span>                    colour_genes_by_score <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>                    label_size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set limits on all chromosomes (to "zoom in" to the 10-20Mb region)</span></span></span>
<span class="r-in"><span><span class="fu">create_hidecan_plot</span><span class="op">(</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>                    <span class="va">chrom_length</span>,</span></span>
<span class="r-in"><span>                    label_size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    chrom_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10e6</span>, <span class="fl">20e6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set limits on some chromosomes only</span></span></span>
<span class="r-in"><span><span class="fu">create_hidecan_plot</span><span class="op">(</span><span class="va">z</span>,</span></span>
<span class="r-in"><span>                    <span class="va">chrom_length</span>,</span></span>
<span class="r-in"><span>                    label_size <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                    chrom_limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"ST4.03ch00"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10e6</span>, <span class="fl">20e6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                                        <span class="st">"ST4.03ch02"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15e6</span>, <span class="fl">25e6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Olivia Angelin-Bonnet.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

